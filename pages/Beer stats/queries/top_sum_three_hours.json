{
  "pluginType": "DB",
  "pluginId": "postgres-plugin",
  "unpublishedAction": {
    "name": "top_sum_three_hours",
    "datasource": {
      "name": "register",
      "pluginId": "postgres-plugin",
      "messages": [],
      "isAutoGenerated": false,
      "id": "register",
      "deleted": false,
      "policies": [],
      "userPermissions": []
    },
    "pageId": "Beer stats",
    "actionConfiguration": {
      "timeoutInMillisecond": 10000,
      "paginationType": "NONE",
      "encodeParamsToggle": true,
      "body": "WITH dates_added AS (\n\t\tSELECT DISTINCT\t CAST(datetime as date) AS date_,\n\t\t\t\t\tsum_three_hours\n\t\tFROM dbt.\"beer_stats\"\n\t\tORDER BY sum_three_hours DESC\n),\nmax_per_date AS (\n\t\tSELECT DISTINCT max(sum_three_hours) OVER(PARTITION BY date_) as beer_liters,\n\t\tdate_\n\t\tFROM dates_added\n\t\tORDER BY beer_liters DESC\n),\nadd_time AS (\n\t  SELECT CAST(min(bs.datetime) + interval '90 minutes' AS time) as end_time,\n\t\t\t\t\t CAST(min(bs.datetime) - interval '90 minutes' AS time) as start_time,\n\t\t\t\t\t bs.sum_three_hours,\n\t\t\t\t\t mpd.date_ \n\tFROM dbt.\"beer_stats\" bs\n\tINNER JOIN max_per_date mpd\n\tON CAST(bs.datetime AS date) = mpd.date_ \n\tAND bs.sum_three_hours = beer_liters\n\tGROUP BY date_,\n\t\t\t\t\t sum_three_hours\n),\ntime_in_string AS (\n\t\tselect sum_three_hours,\n\t\t\t\t\t date_,\n\t\t\t\t\t CONCAT(CAST(EXTRACT(hours FROM start_time) AS text),':',CAST(EXTRACT(minutes FROM start_time) AS text)) as start_time,\n\t\t\t\t\t CONCAT(CAST(EXTRACT(hours FROM end_time) AS text),':',CAST(EXTRACT(minutes FROM end_time) AS text)) as end_time\n\t\tFROM add_time\n)\nselect *\nfrom time_in_string\nORDER BY sum_three_hours DESC\nLIMIT 10",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ]
    },
    "executeOnLoad": true,
    "dynamicBindingPathList": [],
    "isValid": true,
    "invalids": [],
    "messages": [],
    "jsonPathKeys": [],
    "userSetOnLoad": false,
    "confirmBeforeExecute": false,
    "policies": [],
    "userPermissions": []
  },
  "id": "Beer stats_top_sum_three_hours",
  "deleted": false,
  "gitSyncId": "634be61322be2805e0a0683b_634da8a9933761600d81bf49"
}